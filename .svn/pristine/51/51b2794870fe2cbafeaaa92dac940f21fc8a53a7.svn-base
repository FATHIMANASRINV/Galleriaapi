{extends file="layout/base.tpl"}

{block name="header"} 

<link href="{assets_url()}plugins/DataTables/datatables.min.css" rel="stylesheet" />
<link href="{assets_url()}plugins/DataTables/DataTables-1.12.1/css/buttons.dataTables.min.css" rel="stylesheet" />


{/block} 

{block name="body"} 


<div class="row g-0">
	<div class="col-lg-7 ps-lg-2 mb-3">
		<div class="card h-100">
			<div class="card-header">
				<h5 class="mb-0">{lang('wallet_details')}</h5>
			</div>
			<div class="card-body bg-light">
				<h5 class="d-flex justify-content-between"><span>{lang('wallet_amount')}</span><span>{cur_format($current_balance)}</span></h5>
				<hr />
				
				<div class="d-flex justify-content-between fs--1 mb-1 text-success">
					<p class="mb-0">{lang('maximum_request_amount')}</p><span>{cur_format($max_amt)}</span>
				</div>
				<div class="d-flex justify-content-between fs--1 mb-1 text-success">
					<p class="mb-0">{lang('minimum_request_amount')}</p><span>{cur_format($min_amt)}</span>
				</div>
				<div class="d-flex justify-content-between fs--1 mb-1 text-danger">
					<p class="mb-0">{lang('transaction_fee')}</p><span>{$transaction_fee}%</span>
				</div>

				
				
			</div>
			

		</div>

	</div>
	<div class="col-lg-5 pe-lg-2 mb-3">
		<div class="card h-lg-100">
			<div class="card-body p-4 p-sm-5">
				<h5 class="text-center">{lang('payout_request')}</h5>
				
				{form_open('','class="mt-3 needs-validation" novalidate')}
				
				<div class="mb-3">
					<div class="form-group">
						<label class="form-label"></label>
						<div class="controls">
							<input class="form-control" type="number" name="amount" value="{set_value('amount')}" autocomplete="off"  placeholder="{lang('amount')}" required />
							<div class="invalid-feedback">{lang('the_field_required')}</div>
							{form_error("amount")}
						</div>
					</div>
				</div>
				<div class="mb-3">
					<div class="form-group">
						<div class="controls">
							<input class="form-control" type="password" name="security_pin" value="" autocomplete="off" placeholder="{lang('security_pin')}" required />
							<div class="invalid-feedback">{lang('the_field_required')}</div>
							{form_error("security_pin")}
						</div>
					</div>
				</div>
				<button class="btn btn-primary d-block w-100 mt-3" type="submit" name="request" value="request" id="request">{lang('request')}</button>

				{form_close()}
			</div>
		</div>
	</div>
</div>


<div class="row "> 
	<div class="col-sm-12"> 
		<div class="card"> 

			<div class="card-header">
				<h5>{$title}</h5>

			</div>

			<div class="card-content">
				<div class="card-body">  

					<div class="table-responsive">
						<table class="table color-table primary-table" id="dataTable">
							<thead >
								<tr>
									<th>#</th>
									<th>{lang('user_name')}</th>
									<th>{lang('requested_amount')}</th>
									<th>{lang('release_amount')}</th>
									<th>{lang('requested_date')}</th>
									<th>{lang('updated_dates')}</th>
									<th>{lang('by_using')}</th>   
									<th>{lang('status')}</th>  

								</tr>
							</thead>
							<tbody>
								{foreach from=$requests item=v}
								<tr>
									<td>{counter}</td>
									<td>{$v.user_name}</td>
									<td>{cur_format($v.amount)}</td> 
									<td>{cur_format($v.amount-($v.amount*($v.transaction_fee)/100))}</td>
									<td>{$v.requested_date|date_format:"%d-%m-%y"}</td>
									<td>{if !empty($v.updated_date)}
										{* {date('d-m-y',strtotime($v.updated_date))} *}
										{$v.updated_date|date_format:"%d-%m-%y"}
										{/if}
									</td>
									<td>{ucfirst($v.by_using)}</td>  
									<td>
										{if $v.status == 'released' }
										<span class="badge badge rounded-pill badge-soft-success">{ucfirst($v.status)}<span></td>
											{elseif $v.status=='pending'}
											<span class="badge badge rounded-pill badge-soft-warning">{ucfirst($v.status)}<span></td>
												{else}
												<span class="badge badge rounded-pill badge-soft-danger">{ucfirst($v.status)}<span></td>
													{/if}

												</tr> 
												{/foreach}
											</tbody>
										</table>

									</div>
								</div>
							</div>
						</div> 
					</div> 
				</div>


				{/block}

				{block name="footer"}
				<script src="{assets_url()}plugins/DataTables/datatables.min.js"></script>
				<script src="{assets_url('plugins/DataTables/media/js/jquery.dataTables.min.js')}"></script>
				

				<script type="text/javascript">
					$(document).ready( function () {

						$('#dataTable').DataTable();
					} );

				</script>
				<script>
					if ( window.history.replaceState ) {
						window.history.replaceState( null, null, window.location.href );
					}
				</script>
				{/block}