{extends file="layout/base.tpl"}
{block name="header"}
<link rel="stylesheet" type="text/css" href="{assets_url('plugins/select2/select2.min.css')}">
{/block}
{block name="body"}

<div class="card">
	<div class="card-header">
		
		<h5 class="mb-0" data-anchor="data-anchor">{lang('credit_debit_amount')}</h5>

	</div>
	<div class="card-body ">
		
		{form_open('','role="form"  class="row g-3 needs-validation" method="post" name="compose" id="compose" novalidate=""')}


		<div class="col-md-12">
			<label class="form-label">{lang('user_name')}</label>
			<select class="form-control user_name_ajax" name="user_name" id="user_name">
				{if $post_arr['user_name']}
				<option value="{$post_arr['user_name']}" selected>{$post_arr['user_name']}</option>
				{/if}
			</select>
			{form_error('user_name')}
		</div>

		<div class="col-md-12">
			<div class="form-group">
				<label class="form-label" for="validationCustomUsername">{lang('amount')}</label>

				<div class="controls">
					<input type="number" class="form-control" id="amount" name="amount" value="" autocomplete="off" required> 
					<div class="invalid-feedback">{lang('enter_an_amount')}</div>

					{form_error("amount")}

					<div class="form-group" >
						<div id="amount_words_div" style="display: none;">
							<label>{lang('amt_in_words')}</label>
							<input type="text" class="form-control" id="amount_words" name="amount_words"  
							value= "" autocomplete="off" readonly>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="col-12">
			<button type="submit" class="btn btn-primary" name="credit_amount" value="credit_amount" id="credit_amount">{lang('credit_amount')}</button>
			<button class="btn btn-success" type="submit" id="debit_amount" name="debit_amount" value="debit_amount">
				{lang('debit_amount')} 
			</button>
		</div>
		{form_close()}
	</div>
</div>
{/block}
{block name="footer"}

</div>
</div>

<script src="{assets_url('plugins/select2/select2.min.js')}"></script>
<script type="text/javascript"> 
	$('#user_name').select2(); 
</script>

<script type="text/javascript">
	$(document).ready(function(){

		$('#amount').on('blur', function(){

			var value= $(this).val();

            $.post( "{base_url()}admin/business/get_amount_words", { amount: value })
            .done(function( data ) {
             $('#amount_words').val(data);
             $('#amount_words_div').show();

         });

        });

	});
	$(document).ready( function () {

		$('.user_name_ajax').select2({
			placeholder:'{lang('select_a_user')}',
			ajax: {
				url: '{base_url()}admin/autocomplete/getUser_ajax',
				type:'post',
				dataType: 'json',
				delay: 250,
				processResults: function (data) { 
					return {
						results: data
					};

				},
				cache: true
			}

		});

	});
</script>

{/block}