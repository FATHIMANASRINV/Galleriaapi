{extends file="layout/base.tpl"}
{block name="header"} 
<link rel="stylesheet" type="text/css" href="{assets_url('plugins/select2/select2.min.css')}">
<link rel="stylesheet" type="text/css" href="{assets_url('plugins/fileupload/bootstrap-fileupload.min.css')}">
<link href="{assets_url()}/plugins/notify/notify.css" rel="stylesheet" />   
<style>
	.field-icon {
		float: right;
		margin-right: 10px;
		margin-top: -28px;
		position: relative;
		z-index: 2;
		background: none;
		border: none;
		color: #7b7b7b;
		font-size: 1rem;
		font-weight: 600;
	}
</style>
{/block}
{block name="body"} 
<div class="row row-sm">
	<div class="col-sm-12 col-xl-12 col-lg-12 col-md-12 mb-2">
		{form_open('','id="user_wise" name="user_wise" method="post" ')}
		<div class="row row-search">
			<div class="col-md-11">
				<select name="user_id" id="user_id" class="form-control user_name_ajax" {set_select('user_id', set_value('user_id'))} required>
					{if $user_id}
					<option value="{$user_id}" selected>{$user_name}</option>
					{/if}
				</select>
			</div>
			<div class="col-md-1">
				<button type="submit" class="profile-search btn btn-theme px-3"><i class="fa fa-eye m-auto px-1" id="togglePassword"></i></button>
			</div>
		</div>
		{form_close()}
	</div>
</div>
<div class="card">
	<div class="card-body p-0">


		<div class="profile">


			<div class="profile-container">


				<div class="profile-sidebar">
					<div class="desktop-sticky-top">
						<div class="profile-img">
							<img src="{assets_url('images/profile/')}{$user_details['user_photo']}" alt="">
						</div>

						<h4>{$user_details['user_name']}</h4>
						<div class="mb-3 text-inverse text-opacity-50 fw-bold mt-n2">{$user_details['full_name']}</div>
						<p>
							<div> +{$user_details['country_code']}  {$user_details['mobile']}</div>
							<div> {$user_details['address']} </div>
						</p>
						<div class="mb-1">
							<i class="fa fa-map-marker-alt fa-fw text-inverse text-opacity-50"></i>{$user_details['country_name']}
						</div>
						<div class="mb-3">
							<i class="fa fa-link fa-fw text-inverse text-opacity-50"></i>{$user_details['email']}
						</div>

						{* <hr class="mt-4 mb-4"> *}


						{* <div class="fw-bold mb-3 fs-16px">People to follow</div>
						<div class="d-flex align-items-center mb-3">
							<img src="assets/img/user/user-1.jpg" alt="" width="30" class="rounded-circle">
							<div class="flex-fill px-3">
								<div class="fw-bold text-truncate w-100px">Noor Rowe</div>
								<div class="fs-12px text-inverse text-opacity-50">3.1m followers</div>
							</div>
							<a href="#" class="btn btn-sm btn-outline-theme fs-11px">Follow</a>
						</div>
						<div class="d-flex align-items-center mb-3">
							<img src="assets/img/user/user-2.jpg" alt="" width="30" class="rounded-circle">
							<div class="flex-fill px-3">
								<div class="fw-bold text-truncate w-100px">Abbey Parker</div>
								<div class="fs-12px text-inverse text-opacity-50">302k followers</div>
							</div>
							<a href="#" class="btn btn-sm btn-outline-theme fs-11px">Follow</a>
						</div>
						<div class="d-flex align-items-center mb-3">
							<img src="assets/img/user/user-3.jpg" alt="" width="30" class="rounded-circle">
							<div class="flex-fill px-3">
								<div class="fw-bold text-truncate w-100px">Savannah Nicholson</div>
								<div class="fs-12px text-inverse text-opacity-50">720k followers</div>
							</div>
							<a href="#" class="btn btn-sm btn-outline-theme fs-11px">Follow</a>
						</div>
						<div class="d-flex align-items-center mb-3">
							<img src="assets/img/user/user-4.jpg" alt="" width="30" class="rounded-circle">
							<div class="flex-fill px-3">
								<div class="fw-bold text-truncate w-100px">Kenny Bright</div>
								<div class="fs-12px text-inverse text-opacity-50">1.4m followers</div>
							</div>
							<a href="#" class="btn btn-sm btn-outline-theme fs-11px">Follow</a>
						</div>
						<div class="d-flex align-items-center">
							<img src="assets/img/user/user-5.jpg" alt="" width="30" class="rounded-circle">
							<div class="flex-fill px-3">
								<div class="fw-bold text-truncate w-100px">Cara Poole</div>
								<div class="fs-12px text-inverse text-opacity-50">989k followers</div>
							</div>
							<a href="#" class="btn btn-sm btn-outline-theme fs-11px">Follow</a>
						</div> *}
					</div>
				</div>

				<div class="profile-content">
					<ul class="profile-tab nav nav-tabs nav-tabs-v2">
						<li class="nav-item">
							<a href="#profile-post" class="nav-link active" data-bs-toggle="tab">
								<div class="nav-field">{lang('profile')}</div>
								{* <div class="nav-value">382</div> *}
							</a>
						</li>

						<li class="nav-item">
							<a href="#profile-media" class="nav-link" data-bs-toggle="tab">
								<div class="nav-field">{lang('change_password')}</div>
								{* <div class="nav-value">1,397</div> *}
							</a>
						</li>
						<li class="nav-item">
							<a href="#profile-video" class="nav-link" data-bs-toggle="tab">
								<div class="nav-field">{lang('change_security_pin')}</div>
								{* <div class="nav-value">120</div> *}
							</a>
						</li>
		{* <li class="nav-item">
			<a href="#profile-followers" class="nav-link" data-bs-toggle="tab">
				<div class="nav-field">Following</div>
				<div class="nav-value">2,592</div>
			</a>
		</li> *}
	</ul>
	<div class="profile-content-container">

		<div class="row gx-4">
			<div class="col-xl-12">
				<div class="tab-content p-0">

					<div class="tab-pane fade show active" id="profile-post">
						<div class="card mb-3">
							<div class="card-body">

								{form_open_multipart("admin/member/profile?user_name={$user_name}",'role="form"  class="row g-3 needs-validation" method="post" name="compose" id="compose" novalidate=""')}

								<div class="col-lg-6">
									<div class="form-group">
										<label class="form-label" for="first-name">{lang('firstname')}</label>
										<div class="controls">
											<input class="form-control" id="first_name" name="first_name" type="text" value="{$user_details['first_name']}" required />
											<div class="invalid-feedback">{lang('firstname_Field_Required')}</div>
											{form_error("first_name")}
										</div>
									</div>
								</div>
								<div class="col-lg-6">
									<div class="form-group">
										<label class="form-label" for="second-name">{lang('lastname')}</label>
										<div class="controls">
											<input class="form-control" id="second_name" name="second_name" type="text" value="{$user_details['second_name']}" required/>
											<div class="invalid-feedback">{lang('lastname_Field_Required')}</div>
											{form_error("second_name")}
										</div>
									</div>
								</div>
								<div class="col-lg-6">
									<div class="form-group">
										<label class="form-label" for="email">{lang('email')}</label>
										<div class="controls">
											<input class="form-control" id="email" name="email"type="text" value="{$user_details['email']}" required/>
											<div class="invalid-feedback">{lang('email_Field_Required')}</div>
											{form_error("email")}
										</div>
									</div>
								</div>
								<div class="col-lg-6">
									<div class="form-group">
										<label class="form-label" for="mobile">{lang('mobile')}</label>
										<div class="controls">
											<div class="input-group"><span class="input-group-text">+{$user_details['country_code']}</span> 
												<input class="form-control" id="mobile"  name="mobile" type="number" value="{$user_details['mobile']}"required minlength="{value_by_key('phone_number_length')}" maxlength="{value_by_key('phone_number_length')}"
												oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"   required=""/>
												<div class="invalid-feedback">{lang('mobile_Field_Required')}</div>
												{form_error("mobile")}
											</div>
										</div>
									</div>
								</div>
								<div class="col-lg-12">
									<div class="form-group">
										<label class="form-label" for="address">{lang('address')}</label>
										<div class="controls">
											<textarea class="form-control" id="address" name="address" cols="30" rows="5" required>{$user_details['address']}</textarea>
											<div class="invalid-feedback">{lang('address_Field_Required')}</div>
											{form_error("address")}
										</div>
									</div>
								</div>
								<div class="col-lg-6">
									<div class="form-group">
										<label class="form-label" for="city">{lang('city')}</label>
										<div class="controls">
											<input class="form-control" id="city"  name="city" type="text" value="{$user_details['city']}" required/>
											<div class="invalid-feedback">{lang('city_Field_Required')}</div>
											{form_error("city")}
										</div>
									</div>
								</div>
								<div class="col-lg-6">
									<div class="form-group">
										<label class="form-label" for="zip_code">{lang('zipcode')}</label>
										<div class="controls">
											<input class="form-control" id="zip_code" min=0 name="zip_code" type="number" value="{$user_details['zip_code']}"required/>
											<div class="invalid-feedback">{lang('zipcode_Field_Required')}</div>
											{form_error("zip_code")}
										</div>
									</div>
								</div>
								<div class="col-lg-6">
									<label class="form-label" for="Country">{lang('country')}</label>

									<select class="country_ajax  form-control" name="country" id="country"{set_select('country')}>
										{if $user_details['country_name']}
										<option value="{$user_details['country']}" selected>{$user_details['country_name']}</option>
										{/if}
									</select>
									<div class="invalid-feedback">{lang('Country_Field_Required')}</div>
									{form_error("country")}
								</div>
								<div class="col-lg-6">
									<div class="form-group">
										<label class="form-label" for="state">{lang('state')}</label>
										<div class="controls">

											<select name="state" id="state" class="form-control state_ajax" {set_select('state', set_value('state'))} >
												{if $user_details['state'] }
												<option value="{$user_details['state']}" selected>{$user_details['state_name']}</option>
												{/if}
											</select>
											<div class="invalid-feedback">{lang('state_Field_Required')}</div>
											{form_error("state")}
										</div>
									</div>
								</div>
								<div class="col-lg-6">
									<div class="form-group">
										<label class="form-label" for="state">{lang('facebook')}</label>
										<div class="controls">
											<input class="form-control" id="facebook"  name="facebook" type="text" value="{$user_details['facebook']}"/>
											{form_error("facebook")}
											{* <div class="invalid-feedback">{lang('facebook_Field_Required')}</div> *}
										</div>
									</div>
								</div>
								<div class="col-lg-6">
									<div class="form-group">
										<label class="form-label" for="state">{lang('twitter')}</label>
										<div class="controls">
											<input class="form-control" id="twitter"  name="twitter" type="text" value="{$user_details['twitter']}"/>
											{* <div class="invalid-feedback">{lang('twitter_Field_Required')}</div> *}
											{form_error("twitter")}
										</div>
									</div>
								</div>
								<div class="col-lg-6">
									<div class="form-group">
										<label class="form-label" for="state">{lang('linked_in')}</label>
										<div class="controls">
											<input class="form-control" id="linked_in"  name="linked_in" type="text" value="{$user_details['linked_in']}"/>
											{* <div class="invalid-feedback">{lang('twitter_Field_Required')}</div> *}
											{form_error("linked_in")}
										</div>
									</div>
								</div>
								<div class="col-lg-6">
									<div class="form-group">
										<label class="form-label" for="state">{lang('instagram')}</label>
										<div class="controls">
											<input class="form-control" id="instagram"  name="instagram" type="text" value="{$user_details['instagram']}"/>
											{* <div class="invalid-feedback">{lang('twitter_Field_Required')}</div> *}
											{form_error("instagram")}
										</div>
									</div>
								</div>

								<div class="col-md-6">
									<label class="form-label">{lang('userphoto')}</label>                     
									<div class="fileupload fileupload-new " data-provides="fileupload">
										<div class="fileupload-preview thumbnail border" style="width: 200px; height: 150px;"><!-- <img src="{assets_url('images/profile/')}{$user_details['user_photo']}" alt=""> -->
											<img src="{assets_url('images/profile/')}{$user_details['user_photo']}" alt="">
										</div>
										<div>
											<span class="btn btn-theme me-1 mb-1 btn-file">
												<span class="fileupload-new">{lang('select_image')}</span>
												<span class="fileupload-exists">{lang('change')}</span>
												<input type="file" name="userfile">
											</span>
											<a href="#" class="btn btn-outline-dark me-1 mb-1 fileupload-exists" data-dismiss="fileupload">{lang('remove')}</a>
										</div>
									</div>
								</div>


								<div class="col-12 d-flex justify-content-end">
									<button class="btn btn-theme" name="profile_update" value="profile_update" type="submit">{lang('update')}</button>
								</div>
								{form_close()}
							</div>
							<div class="card-arrow">
								<div class="card-arrow-top-left"></div>
								<div class="card-arrow-top-right"></div>
								<div class="card-arrow-bottom-left"></div>
								<div class="card-arrow-bottom-right"></div>
							</div>
						</div>
						
					</div>


					<div class="tab-pane fade" id="profile-media">
						<div class="card mb-3">
							{* <div class="card-header fw-bold bg-transparent">May 20</div> *}
							<div class="card-body">
								{form_open("admin/member/profile?user_name={$user_name}",'class="form needs-validation" novalidate=""')}

								<div class="mb-3">
									<div class="form-group">
										<label class="form-label" for="new-password">{lang('new_password')}</label>
										<div class="controls">
											<input class="form-control" id="new_password" type="password" name="new_password" required/>
											<div class="invalid-feedback">{lang('the_field_required')}</div>
											{form_error("new_password")}
											<button type="button" id="btnToggle" class="field-icon"><i id="eyeIcon" class="fa fa-eye"></i></button>
										</div>
									</div>
								</div>
								<div class="mb-3">
									<div class="form-group">
										<label class="form-label" for="confirm-password">{lang('confirm_password')}</label>
										<div class="controls">
											<input class="form-control" id="confirm_password" type="password" name="confirm_password" required />
											<div class="invalid-feedback">{lang('the_field_required')}</div>
											{form_error("confirm_password")}
											<button type="button" id="btnToggle_c" class="field-icon"><i id="eyeIcon_c" class="fa fa-eye"></i></button>
										</div>
									</div>
								</div>
								<button class="btn btn-theme d-block w-100" type="submit" name="psw_update" value="psw_update">{lang('update_password')}</button>
								{form_close()}
							</div>
							<div class="card-arrow">
								<div class="card-arrow-top-left"></div>
								<div class="card-arrow-top-right"></div>
								<div class="card-arrow-bottom-left"></div>
								<div class="card-arrow-bottom-right"></div>
							</div>
						</div>

					</div>

				</div>

				<div class="tab-pane fade" id="profile-video">
					<div class="card mb-3">
						{* <div class="card-header fw-bold bg-transparent">Collections #1</div> *}
						<div class="card-body">
							{form_open("admin/member/profile?user_name={$user_name}",'class="form needs-validation" novalidate=""')}

							<div class="mb-3">
								<div class="form-group">
									<label class="form-label" for="new-password">{lang('new_pin')}</label>
									<div class="controls">
										<input class="form-control" id="new_pin" type="password" name="new_pin" required />
										<div class="invalid-feedback">{lang('the_field_required')}</div>
										{form_error("new_pin")}
										<button type="button" id="security_pin" class="field-icon"><i id="eye_icon" class="fa fa-eye"></i></button>
									</div>
								</div>
							</div>
							<div class="mb-3">
								<div class="form-group">
									<label class="form-label" for="confirm-password">{lang('confirm_pin')}</label>
									<div class="controls">
										<input class="form-control" id="confirm_pin" type="password" name="confirm_pin" required />
										<div class="invalid-feedback">{lang('the_field_required')}</div>
										{form_error("confirm_pin")}
										<button type="button" id="security_pin_c" class="field-icon"><i id="eye_icon_c" class="fa fa-eye"></i></button>
									</div>
								</div>
							</div>
							<button class="btn btn-theme d-block w-100" type="submit" name="spin_update" value="spin_update">{lang('update_security_pin')}</button>
							{form_close()}
						</div>
						<div class="card-arrow">
							<div class="card-arrow-top-left"></div>
							<div class="card-arrow-top-right"></div>
							<div class="card-arrow-bottom-left"></div>
							<div class="card-arrow-bottom-right"></div>
						</div>
					</div>

				</div>

			</div>
		</div>

	</div>
</div>
</div>

</div>

</div>

</div>

</div>
{/block}
{block name="footer"} 
<script src="{assets_url('plugins/select2/select2.min.js')}"></script>
<script src="{assets_url('plugins/fileupload/bootstrap-fileupload.min.js')}"></script>
<script src="{assets_url()}/plugins/notify/notify.js"></script> 

<script type="text/javascript">
	let passwordInput = document.getElementById('new_password'),
	toggle = document.getElementById('btnToggle'),
	icon =  document.getElementById('eyeIcon');

	let passwordInput_c = document.getElementById('confirm_password'),
	toggle_c = document.getElementById('btnToggle_c'),
	icon_c =  document.getElementById('eyeIcon_c');

	function togglePassword() {
		if (passwordInput.type === 'password') {
			passwordInput.type = 'text';
			icon.classList.remove("fa-eye");
			icon.classList.add("fa-eye-slash");
		} else {
			passwordInput.type = 'password';
			icon.classList.remove("fa-eye-slash");
			icon.classList.add("fa-eye");
		}
	}

	function togglePassword_c() {
		if (passwordInput_c.type === 'password') {
			passwordInput_c.type = 'text';
			icon_c.classList.remove("fa-eye");
			icon_c.classList.add("fa-eye-slash");
		} else {
			passwordInput_c.type = 'password';
			icon_c.classList.remove("fa-eye-slash");
			icon_c.classList.add("fa-eye");
		}
	}
	function checkInput() {
	}

	toggle.addEventListener('click', togglePassword, false);
	passwordInput.addEventListener('keyup', checkInput, false);


	toggle_c.addEventListener('click', togglePassword_c, false);
	passwordInput_c.addEventListener('keyup', checkInput, false);

</script>
<script type="text/javascript">
	let securityInput = document.getElementById('new_pin'),
	pin = document.getElementById('security_pin'),
	simbol =  document.getElementById('eye_icon');

	let securityInput_c = document.getElementById('confirm_pin'),
	pin_c = document.getElementById('security_pin_c'),
	simbol_c =  document.getElementById('eye_icon_c');

	function toggleSecurity() {
		if (securityInput.type === 'password') {
			securityInput.type = 'text';
			simbol.classList.remove("fa-eye");
			simbol.classList.add("fa-eye-slash");
		} else {
			securityInput.type = 'password';
			simbol.classList.remove("fa-eye-slash");
			simbol.classList.add("fa-eye");
		}
	}

	function toggleSecurity_c() {
		if (securityInput_c.type === 'password') {
			securityInput_c.type = 'text';
			simbol_c.classList.remove("fa-eye");
			simbol_c.classList.add("fa-eye-slash");
		} else {
			securityInput_c.type = 'password';
			simbol_c.classList.remove("fa-eye-slash");
			simbol_c.classList.add("fa-eye");
		}
	}
	function checkSecurity() {
	}

	pin.addEventListener('click', toggleSecurity, false);
	securityInput.addEventListener('keyup', checkSecurity, false);


	pin_c.addEventListener('click', toggleSecurity_c, false);
	securityInput_c.addEventListener('keyup', checkSecurity, false);

</script>


<script type="text/javascript">

	$(document).ready(function(){
		$('.user_name_ajax').select2({
			placeholder: '{lang('select_a_user')}',
			ajax: {
				url: '{base_url()}admin/autocomplete/getUser_ajax',
				type:'post',
				dataType: 'json',
				delay: 250,
				processResults: function (data) { 
					return {
						results: data
					};

				},
				cache: true
			}

		}); 
		var countrySelect = $('.country_ajax');
		var stateSelect = $('.state_ajax');


		countrySelect.select2({
			placeholder: 'Select a Country',
			ajax: {
				url:'{base_url()}signup/get-country-ajax',
				type: 'post',
				dataType: 'json',
				delay:250,
				processResults: function(data) {
					return {
						results: data
					};
				}
			},
		});
		countrySelect.on('select2:select', function (e) {


			stateSelect.val(null).trigger('change');
		});


		stateSelect.select2({
			placeholder: 'Select a State',
			ajax: {
				url: '{base_url()}admin/autocomplete/getState_ajax',
				data: function (params) {
					var country_id = $( "select#country option:checked" ).val();
					var query = {
						search: params.term,
						country_id: country_id,
						registerd_status: true,
						type: 'public'
					}
					return query;
				},
				type:'post',
				dataType: 'json',
				delay: 250,
				processResults: function (data) { 
					return {
						results: data
					};
				},
				cache: true
			}

		}); 
		$('.details').click(function(){
			$('#empModal').modal('show'); 
		});
	}); 
	(function () {
		'use strict'

		var forms = document.querySelectorAll('.needs-validation')
		Array.prototype.slice.call(forms)
		.forEach(function (form) {
			form.addEventListener('submit', function (event) {
				if (!form.checkValidity()) {
					event.preventDefault()
					event.stopPropagation()
				}

				form.classList.add('was-validated')
			}, false)
		})
	})();
	function copyReferral(element) {
		var $temp = $("<input>");
		$("body").append($temp);
		$temp.val('{base_url()}referral/{$user_name}').select();
		document.execCommand("copy");
		$temp.remove();
		$.notify(
			"{lang('copied_the_referral')}", 
			{ color: "#fff", background: "#38D9C8",blur: 0.4, delay:5000}
			);
	}
</script>
{/block}