{extends file="layout/base.tpl"}
{block name="header"}  
<link href="{assets_url()}plugins/DataTables/datatables.min.css" rel="stylesheet" />
<link href="{assets_url()}plugins/DataTables/DataTables-1.12.1/css/buttons.dataTables.min.css" rel="stylesheet" />
<link href="{assets_url()}plugins/select2/select2.min.css" rel="stylesheet" />
<link rel="stylesheet" type="text/css" href="{assets_url('plugins/fileupload/bootstrap-fileupload.min.css')}">
<link rel="stylesheet" href="{assets_url('plugins/dropzone/dropzone.min.css')}" type="text/css" />
<style type="text/css">
    .upload__img-close:after,
    .upload__imgs-close:after {
        content: "\2716";
        font-size: 14px;
        color: #fff;
    }
/*.upload__btn-box {
    margin-bottom: 10px;
}
.upload__img-wrap {
    display: flex;
    flex-wrap: wrap;
    margin: 0 -10px;
}
.upload__img-box {
    width: 200px;
    padding: 0 10px;
    margin-bottom: 12px;
}*/
.upload__img-close,
.upload__imgs-close {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background-color: rgba(0, 0, 0, 0.5);
/*    position: absolute;*/
top: 10px;
right: 10px;
text-align: center;
line-height: 24px;
z-index: 1;
cursor: pointer;
}
</style>
{/block}
{block name="body"} 
<div class="modal fade bd-example-modal-lg" id="modal-product-add"  tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"  aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myLargeModalLabel">{lang('Add_Product')}</h4>
                <button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>

            <div class="modal-body">

                <ul class="nav nav-tabs nav-primary m-b-30" id="pills-warningtab" role="tablist">
                    <li class="nav-item"><a class="nav-link active" id="pills-warning-general-tab" data-bs-toggle="pill" href="#pills-warning-general" role="tab" aria-controls="pills-warning-general" aria-selected="true"><i class="icofont icofont-ui-home"></i>{lang('General')}</a></li>

                    <li class="nav-item"><a class="nav-link dimension" id="pills-warning-data-tab" data-bs-toggle="pill" href="#pills-warning-data" role="tab" aria-controls="pills-warning-data" aria-selected="true" ><i class="icofont icofont-ui-home"></i>{lang('data')}</a></li>

                    
                    <li class="nav-item"><a class="nav-link" id="pills-warning-images-tab" data-bs-toggle="pill" href="#pills-warning-images" role="tab" aria-controls="pills-warning-images" aria-selected="false"><i class="icofont icofont-contacts"></i>{lang('image')}</a></li>


                </ul>                 
                {form_open_multipart('','id="add-form" class="needs-validation" novalidate="" ')}

                <div class="tab-content " id="pills-warningtabContent">  

                    <div class="tab-pane fade show active" id="pills-warning-general" role="tabpanel" aria-labelledby="pills-warning-general-tab">



                        <input type="hidden" name="submit" value="add">


                        <div class="form-group mb-3">
                            <div class="col-sm-12">
                                <input class="form-control" type="text" name="product_name" id="product_name" placeholder="{lang('Product_Name')}" required autocomplete="off">
                                <div class="invalid-feedback">
                                    {lang('field_required')}
                                </div>
                            </div>
                        </div>

                        <div class="form-group mb-3">
                            <div class="col-sm-12">
                                <input class="form-control" type="text" name="product_code" id="product_code" placeholder="{lang('product_code')}" required autocomplete="off">
                                <div class="invalid-feedback">
                                    {lang('field_required')}
                                </div>
                            </div>
                        </div>


                        <div class="form-group mb-3">
                            <div class="col-sm-12">

                                <textarea class="form-control "  name="description"id="description" id="validationTextarea"
                                placeholder="Description" required=""></textarea>

                                <div class="invalid-feedback">
                                    {lang('field_required')}
                                </div>
                            </div>
                        </div>
                        <div class="form-group mb-3">
                            <div class="col-sm-12">
                                <input class="form-control" type="number" id="sort_order"placeholder="{lang('Sort_Order')}" name="sort_order"  required autocomplete="off">
                                <div class="invalid-feedback">
                                    {lang('field_required')}
                                </div>
                            </div>
                        </div> 
                        <div class="form-group mb-3"> 
                            <select class="category_async col-sm-12 " required name="category_id" id="category_id" ></select> 
                            <div class="invalid-feedback">
                                {lang('field_required')}
                            </div>
                        </div>

                        {* <div class="form-group mb-3"> 
                            <select class="brand_async col-sm-12" required name="brand" id="brand"></select> 
                            <div class="invalid-feedback">
                                {lang('field_required')}
                            </div>
                        </div> *}


                        <div class="form-group mb-3">
                            <div class="col-sm-12">
                                <input class="form-control" type="text" name="price" id="price" placeholder="{lang('Product_price')}" required autocomplete="off">
                                <div class="invalid-feedback">
                                    {lang('field_required')}
                                </div>
                            </div>
                        </div>

                        <div class="form-group mb-3">
                            <div class="col-sm-12">
                              <input class="form-control" type="text" name="strike_price"  id="strike_price"placeholder="{lang('Strike_price')}" autocomplete="off">
                              {* <select class="offer_async col-sm-12" name="offer_percentage" id="strike_price"></select>  *}

                          </div>
                      </div>
                      <div class="form-group mb-3">
                        <div class="col-sm-12">
                            <input class="form-control" type="text" name="shipping_charge" id="shipping_charge"placeholder="{lang('Shipping_Charge')}" autocomplete="off">
                        </div>
                    </div>

                    <div class="form-group mb-3">
                        <div class="col-sm-12">
                            <input class="form-control" type="text" name="quantity" id="quantity"placeholder="{lang('Quantity')}" value="0" required autocomplete="off">
                            <div class="invalid-feedback">
                                {lang('field_required')}
                            </div>
                        </div>
                    </div>

                {*     <div class="form-group mb-3">
                        <div class="col-sm-12">
                            <input class="form-control" type="text" id="video_url"placeholder="{lang('Video_URL')}" name="video_url"  autocomplete="off">
                            <div class="invalid-feedback">
                                {lang('field_required')}
                            </div>
                        </div>
                    </div>  
                    <div class="form-group mb-3">
                        <div class="col-sm-12">
                            <textarea class="form-control" type="text" id="provider_info"placeholder="{lang('provider_info')}" name="provider_info"  autocomplete="off"></textarea>
                            <div class="invalid-feedback">
                                {lang('field_required')}
                            </div>
                        </div>
                    </div>   *}

                </div>
                <div class="tab-pane fade" id="pills-warning-data" role="tabpanel" aria-labelledby="pills-warning-data-tab">
                   <div class="add-forms">
                   </div>
                   <div class="form-group mb-3">
                    <div class="card-body animate-chk b-light">
                        <div class="row">
                            <label>{lang('Color')}</label>

                            <div class="row">
                                {foreach $color as $v}
                                <div class="col-sm-2">
                                    <div class="form-check mb-3">
                                        <input class="form-check-input" type="checkbox" name="color_id[{$v.id}]" id="color_id_{$v.id}" value="{$v.id}"  >
                                        <label class="form-check-label" for="color_id_{$v.id}"><span class="badge digits" style="background-color:{$v.color_code}">{$v.name}</span></label>
                                    </div>
                                </div>
                                {/foreach} 
                            </div>

                        </div>
                    </div>
                </div>
                <div class="form-group mb-3">
                    <div class="card-body animate-chk b-light">
                        <div class="row">
                            <label>{lang('Size')}</label>
                            <div class="row dimension_data ">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer"> 

                    <button class="btn btn-primary btn-air-primary add-pro" type="submit" name="add" value="Submit" >{lang('Add_Product')}</button>
                </div>
            </div> 
            {form_close()}  
            <div class="tab-pane fade" id="pills-warning-images" role="tabpanel" aria-labelledby="pills-warning-images-tab">



                {form_open_multipart('','id="image-form" class="needs-validation" novalidate="" ')}


                <div class="addD-forms">
                </div>
                <div class="add-imgss" style="display:none;">
                    <input type="hidden" class="product_id_img" value="" name="product_id_img">
                    <input type="hidden" class="submit" value="add" name="submit">

                    <div id="imageUpload" class="dropzone"></div>
                    <div class="modal-footer image-footer"> 
                        <button class="btn btn-light btn-air-light" type="button" data-bs-dismiss="modal" data-bs-original-title="" title="">{lang('Close')}</button>
                        <button class="btn btn-primary btn-air-primary add-image-footer" type="submit" name="images" value="Submit" >{lang('Add_Images')}</button>
                    </div>
                </div>
                {form_close()}         
            </div>



        </div>


    </div>
</div>
</div>
</div>

<div class="modal fade bd-example-modal-lg" id="modal-product-edit" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">

        </div>
    </div>
</div>
<div class="row">
    <div class="col-sm-12 col-xl-12">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">{lang('Product_Details')}</h5>
                <div class="justify-content-right" align="right">
                    <button align="right" class="btn btn-outline-primary btn-pill btn-air-primary" type="button" data-bs-toggle="modal" data-bs-target="#modal-product-add">+ {lang('Add_Product')}</button>
                </div>
            </div>

            <div class="card-body">
                <div class="table-responsive product-table">
                    <table class="table display" id="dataTable">
                        <thead class="bg-light-dark">
                            <tr>
                                <th>#</th>
                                <th>{lang('image')}</th>
                                <th>{lang('name')}</th>
                                <th>{lang('Price')} ( {cur_symbol()})</th>
                                <th>{lang('Remaining')}</th>
                                <th>{lang('text_date')}</th>
                                <th>{lang('text_actions')}</th>
                            </tr>
                        </thead>

                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{/block}
{block name="footer"}

<script src="{assets_url()}plugins/DataTables/datatables.min.js"></script>
<script src="{assets_url('plugins/DataTables/DataTables-1.12.1/js/jquery.dataTables.min.js')}"></script>
<script src="{assets_url()}plugins/select2/select2.min.js"></script>
<script  src="{assets_url('theme/js/editor/ckeditor/ckeditor.js')}"></script>  
<script  src="{assets_url('theme/js/editor/ckeditor/adapters/jquery.js')}"></script>  
<script  src="{assets_url('theme/js/editor/ckeditor/styles.js')}"></script>  
<script  src="{assets_url('theme/js/bootstrap/bootstrap.js')}"></script>  
<script  src="{assets_url('theme/js/editor/ckeditor/ckeditor.js')}"></script> 
<script  src="{assets_url('theme/js/select2/select2.full.min.js')}"></script>  
<script src="{assets_url('plugins/fileupload/bootstrap-fileupload.min.js')}"></script>
<script  src="{assets_url('plugins/dropzone/dropzone.js')}"></script>  
<script type="text/javascript">
    $('.category_async').select2({
        placeholder: 'Select a Category',
        dropdownParent: $('.category_async').parent(),
        // multiple:true,
        allowClear: true,
        ajax: {
            url:'{base_url()}{log_user_type()}/autocomplete/product_categories',

            type: 'post',
            dataType: 'json',
            delay:250,
            processResults: function(data) {
                return {
                    results: data
                };
            }
        },
    }); 

    $('.category_async').change( function(){ 
        $('.dimension_async').val(null).trigger('change'); 
    });


    

    $('body').on('click', '.dimension', function() {
        var val=[];
        var cat_sel = $("#category_id").find('option:selected');
        cat_sel.each(function(){
            val.push($(this).val());
        });
        // console.log(val);
        if(val.length!=0){
            $.post( "{base_url()}admin/inventory/get_dimensions", { category_id: val })
            .done(function( response ) { 

                if(response.success){ 

                    var content ='';
                    $(response.data).each(function(key, value) {

                        content +='<div class="col-sm-3">';
                        content +='<div class="form-check mb-3">';
                        content +='<input class="form-check-input" type="checkbox" name="dimension_id['+value.id+']" id="dimension_id_'+value.id+'" value="'+value.id+'">';
                        content +='<label class="form-check-label" for="dimension_id_'+value.id+'">'+value.name+'</label>';
                        content +='</div>';
                        content +=' </div>';
                    });
                    $(".dimension_data").html(content);
                }
                val.remove();
            });
        }
    });

    // });



    // $.each(document.querySelectorAll( '.ckedit' ) , function(key , element){
    //     // console.log($(element).attr('class'))
    //     var val = $(element).data('code')
    //     console.log(val)
    //     var descriptionEdit;
    //     var editor = ClassicEditor
    //     .create( document.querySelector( '#lang_'+val ),{
    //         language: val
    //     })
    //     .then( editor => {
    //         window.editor = editor;
    //         descriptionEdit = editor;

    //     } )
    //     .catch( error => {
    //         console.error( error );
    //     } );


    // })


    $(document).on("submit", "#add-form", function(event)
    {
        var form = $(this)
        event.preventDefault();
        $.ajax({
            url: "{base_url()}admin/inventory/save-product",
            type: $(this).attr("method"),
            dataType: "JSON",
            data: new FormData(this),
            processData: false,
            contentType: false,
            beforeSend: function(){
                $("#add-form .errorMsg").slideUp(500).remove();
                $("#add-form .fieldErrorMsg").slideUp(500).remove();
                $("#add-form .help-block").slideUp(500).remove();


            },
            success: function (response, status)
            {
                if(response.success){
                    $('.add-pro').hide();
                    $('.image-footer').show();
                    $('.add-imgss').show();
                    $('.product_id_img').val(response.product_id);
                    var errorElement = '<div class="alert alert-success outline alert-dismissible fade show errorMsg" role="alert"><p><i class="fa fa-check"></i> '+ response.msg +'</p><button class="btn-close" type="button" data-bs-dismiss="alert" aria-label="Close"></button></div>';

                    $("#add-form").find('.add-forms').prepend( errorElement );
                    $("#add-form .add-forms").fadeTo(1000, 500).slideUp(500, function() {
                        $("#add-form .add-forms").slideUp(500)
                    });
                    $("#add-form .errorMsg").fadeTo(3000, 500).slideUp(500, function() {
                        $("#add-form .errorMsg").slideUp(500)
                    });

                    descriptionEdit.setData( '' );
                    $("#add-form").trigger("reset");
                    $("#add-form").removeClass("was-validated");
                    detailed_table.ajax.reload(null, false );

                }else{


                    var errorElement = '<div class="alert alert-secondary outline alert-dismissible fade show errorMsg" role="alert"><p><i class="fa fa-thumbs-o-down"></i> '+ response.msg +'</p><button class="btn-close" type="button" data-bs-dismiss="alert" aria-label="Close"></button></div>';
                    form.find('.modal-body').prepend( errorElement );
                    // showFormErrors(response.errors);
                    $.each(response.errors, function(field, msg){
                        console.log(msg);
                        $('#'+field).parent().append( '<div class="text-danger fieldErrorMsg">'+msg+'.</div>' );
                    })
                }
            },
        });
    });

    // var descriptionEdit;
    // var editor = ClassicEditor
    // .create( document.querySelector( '.description' ) )
    // .then( editor => {
    //     window.editor = editor;
    //     descriptionEdit = editor;

    // } )
    // .catch( error => {
    //     console.error( error );
    // } );
    // var descriptionEdit;
    // var editor = ClassicEditor
    // .create( document.querySelector( '.specification' ) )
    // .then( editor => {
    //     window.editor = editor;
    //     descriptionEdit = editor;

    // } )
    // .catch( error => {
    //     console.error( error );
    // } );


    var detailed_table = $('#dataTable').DataTable({

        'processing': true,
        'serverSide': true,
        "autoWidth": false,
        'serverMethod': 'post', 
        "pagingType": "full_numbers",
        "pageLength": 10,
        "sortable": true,

        "aaSorting": [],
        "order": [],
        // "aoColumnDefs": [
        // { "bSortable": false, "aTargets": [ 0, 1, 2, 3, 4] },  
        // ],


        "columnDefs": [{
            "targets": 'no-sort',
            "orderable": false,
            "order": [],
        }],

        'ajax': {
            'url':'{base_url(log_user_type())}/inventory/get_products_dataTable',
            'type': "POST", 
            'data' : { 
                'category_id' : '{$search_arr['category_id']}',
                // 'status' : '{$search_arr['status']}',
                'order_by' : '{$search_arr['order_by']}',  
            }

        },

        'columns': [

            { data: 'index'},
            { data: 'image', mRender: function(data, type, row) {
                var link = '<div class="flag" style="width: 100%;"><img src="{assets_url()}images/products/'+row.image+'" class="img-thumbnail" alt="Product image"style="max-width: 70px;"></div>';
                return link;
            }},

            { data: 'product_name', mRender: function(data, type, row) {
                var html = '<h6> '+data+' </h6>';
                html += '<span><small>'+ row['category_name'] +'</small></span>';

                if(row['quantity'] > 10){ 
                    html +=  '<span class="clearfix"></span>';
                    html +=  '<span class="font-success">In Stock</span>'; 
                }else if(row['quantity'] <= 0){ 
                    html +=  '<span class="clearfix"></span>';
                    html +=  '<span class="font-danger">Out of stock</span>'; 
                }else { 
                    html +=  '<span class="clearfix"></span>';
                    html +=  '<span class="font-primary">Low Stock</span>'; 
                }
                return html;
            }},

            { data: 'price', mRender: function(data, type, row) {
                var html = data ; 
                if(row['strike_price'] > 0){
                    html +=  '<span class="clearfix"></span>';
                    html +=  '<del>'+row['strike_price']+'</del>'; 
                }
                return html;
            }},
            { data: 'quantity'},
            { data: 'date_added'},
            { data: 'id', mRender: function(data, type, row) {

                var  link= ''
                link +="<a rel='tooltip' title='Edit' class='btn btn-outline-success btn-sm me-3 items_edit' type='button' data-original-title='Edit' data-enc_id='"+row.enc_id+"' ><i class='fa fa-edit'></i></a>";
            // link +="<a rel='tooltip' title='Inactive' class='btn btn-outline-danger btn-sm delete_item' type='button' data-original-title='Inactive' data-enc_id='"+row.enc_id+"' ><i class='fa fa-close'></i></a>";
                if(row.status=='active'){
                   link +="<a rel='tooltip' title='Inactivate' class='btn btn-outline-danger btn-sm me-3 delete_item' type='button' data-original-title='Inactivate' data-enc_id='"+row.enc_id+"' data-status='"+row.status+"'><i class='fa fa-close'></i></a>";

               }else{
                 link +="<a rel='tooltip' title='Activate' class='btn btn-outline-info btn-sm me-3 delete_item' type='button' data-original-title='Activate' data-enc_id='"+row.enc_id+"'  data-status='"+row.status+"'><i class='fa fa-check'></i></a>";
             }
             link +="<a rel='tooltip' title='Delete' class='btn btn-outline-danger btn-sm me-3 items_delete' type='button' data-original-title='Edit' data-enc_id='"+row.enc_id+"' ><i class='fa fa-trash'></i></a>";

             return link;
         }}, 
         ],
        success: function(response) { 
        } 
    });

    $(document).on("click", ".items_edit", function(event){

        $.ajax({
            type:'POST',
            url:"{base_url('admin/inventory/get-product-info')}",
            data: { id: $(this).data('enc_id')} ,
            dataType:'json',
            beforeSend: function(){
                $('#modal-product-edit').modal('show'); 
            }
        })
        .done(function( response ) {
            if(response.success){
                $('#modal-product-edit .modal-content').html(response.html); 
                // if (CKEDITOR.instances.description) { 
                //     console.log(CKEDITOR.instances)
                //     CKEDITOR.instances.description.destroy();
                //     CKEDITOR.replace( 'description', {
                //         on: {
                //             contentDom: function( evt ) {
                //                 evt.editor.editable().on( 'contextmenu', function( contextEvent ) {
                //                     var path = evt.editor.elementPath();

                //                     if ( !path.contains( 'table' ) ) {
                //                         contextEvent.cancel();
                //                     }
                //                 }, null, null, 5 );
                //             }
                //         }
                //     } ); 
                // }
            }
        }); 

    }); 

    $(document).on("submit", "#edit-form", function(event)
    {
        var form = $(this)
        event.preventDefault();
        $.ajax({
            url: "{base_url()}admin/inventory/save-product",
            type: $(this).attr("method"),
            dataType: "JSON",
            data: new FormData(this),
            processData: false,
            contentType: false,
            beforeSend: function(){
                $("#edit-form .errorMsg").slideUp(500).remove();
                $("#edit-form .fieldErrorMsg").slideUp(500).remove();
                // $("#edit-form .help-block").slideUp(500).remove();

            },
            success: function (response, status)
            {
                if(response.success){

                    var errorElement = '<div class="alert alert-success outline alert-dismissible fade show errorMsg" role="alert"><p><i class="fa fa-check"></i> '+ response.msg +'</p><button class="btn-close" type="button" data-bs-dismiss="alert" aria-label="Close"></button></div>';

                    form.find('.modal-body').prepend( errorElement );
                    $("#edit-form .errorMsg").fadeTo(2000, 500).slideUp(500, function() {
                        $("#edit-form .errorMsg").slideUp(500)
                    });

                    detailed_table.ajax.reload(null, false );
                    // setTimeout(function(){
                    //     $('#modal-product-edit').modal('hide')
                    // }, 200);
                }else{


                    var errorElement = '<div class="alert alert-secondary outline alert-dismissible fade show errorMsg" role="alert"><p><i class="fa fa-thumbs-o-down"></i> '+ response.msg +'</p><button class="btn-close" type="button" data-bs-dismiss="alert" aria-label="Close"></button></div>';
                    form.find('.modal-body').prepend( errorElement );
                    // showFormErrors(response.errors);
                    $.each(response.errors, function(field, msg){
                        $('.'+field).parent().append( '<div class="text-danger fieldErrorMsg">'+msg+'.</div>' );
                    })
                }
            },
        });
    });
    $(document).on("click", ".delete_item", function(event){

        $.ajax({
            type:'POST',
            url:"{base_url('admin/inventory/change_status')}",
            data: { id: $(this).data('enc_id') , status: $(this).data('status')} ,
            dataType:'json',

        })
        .done(function( response ) {  
            if(response.success){
                toastr.success(response.msg, "success: ",{ progressBar:!0 })
                detailed_table.ajax.reload(null, false );
            }else{
                toastr.error(response.msg, "error: ",{ progressBar:!0 })

            }

        }); 

    }); 
</script>

<script type="text/javascript">
   Dropzone.autoDiscover = false;

   myDropzone = new Dropzone('div#imageUpload', {
      addRemoveLinks: true,
      autoProcessQueue: false,
      uploadMultiple: true,
      parallelUploads: 100,
      maxFiles: 1000,
      paramName: 'file',
      clickable: true,
      url: "{base_url()}admin/inventory/save-image",

      init: function () {
        var myDropzone = this;
        $('.add-image-footer').click(function (e) {
          e.preventDefault();
          myDropzone.processQueue();
          return false;
      });

        this.on('sending', function (file, xhr, formData) {
          var data =  $('#image-form').serializeArray();
          $.each(data, function (key, el) {
            formData.append(el.name, el.value);
        });
          // console.log(formData);

      });
    },
    error: function (file, response){
        if ($.type(response) === "string")
          var message = response;
      else
          var message = response.message;
      file.previewElement.classList.add("dz-error");
      _ref = file.previewElement.querySelectorAll("[data-dz-errormessage]");
      _results = [];
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          node = _ref[_i];
          _results.push(node.textContent = message);
      }
      return _results;
  },
  successmultiple: function (file, response) {
    // console.log(file, response);
    detailed_table.ajax.reload(null, false );
    var errorElement = '<div class="alert alert-success outline alert-dismissible fade show errorMsg" role="alert"><p><i class="fa fa-check"></i> '+ response.msg +'</p><button class="btn-close" type="button" data-bs-dismiss="alert" aria-label="Close"></button></div>';
    $("#image-form").find('.addD-forms').prepend( errorElement );
    $("#image-form .addD-forms").fadeTo(1000, 500).slideUp(500, function() {
        $("#image-form .addD-forms").slideUp(500)
    });
    setTimeout(function(){
        $('#modal-product-add').modal('hide')
    }, 500);
    this.removeAllFiles(true); 
},
completemultiple: function (file, response) {
    console.log(file, response, "completemultiple");
        //$modal.modal("show");
},
reset: function () {
    console.log("resetFiles");
    remove_files();
}
});

   $(document).on("click", ".items_delete", function(event){

        var val=$(this).data('enc_id');
        // alert(val);
        $.ajax({
            type:'POST',
            url:"{base_url('admin/inventory/deleteProductManagement')}",
            data: { id: val} ,
            dataType:'json',
           
        })
        .done(function( response ) {  
            if(response.status){
                detailed_table.ajax.reload(null,false);
                toastr.success(response.msg,'success:')
            }
            else{
                toastr.error(response.msg, "error: ",{ progressBar:!0 })

            }    

           
        }); 

    }); 


</script>
{/block}