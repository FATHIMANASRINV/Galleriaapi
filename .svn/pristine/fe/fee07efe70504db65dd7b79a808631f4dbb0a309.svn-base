{extends file="layout/base.tpl"}
{block name="header"} 
<link href="{assets_url()}plugins/select2/select2.min.css" rel="stylesheet" />

{/block}
{block name="body"}


<main class="main" id="top">
	
	<div class="row">
		<div class="col-12">
			<div class="card-body ">
				{form_open()} 
				<div class="form-group">
					<div class="row">
						<label class="col-sm-2 col-form-label">
							{lang('user_name')} <span class="symbol required"></span>
						</label>
						<div class="col-sm-4">
							<select name="user_id" id="user_id" class="form-control user_name_ajax" {set_select('user_id', set_value('user_id'))} required>
								{if $user_name}
								<option value="{$user_id}" selected>{$user_name}</option>
								{/if}
							</select>
							{form_error("user_name")}
						</div> 
						<div class="col-sm-3 " > 
							<button class="btn btn-primary" name="view_user_tree" id="view_user_tree" value="view_user_tree" type="submit">{lang('search')}</button>
						</div>
					</div>
				</div>
				{form_close()}  
			</div>


			<div class="card-body fs--1 p-0">

				{foreach $activity_log as $v}
				<a class="border-bottom-0 notification rounded-0 border-x-0 border border-300" href="#!">
					<div class="notification-avatar">
						<div class="avatar avatar-xl me-3">
							<div class="avatar-emoji rounded-circle "><span role="img" aria-label="Emoji">üìãÔ∏è</span></div>
						</div>
					</div>
					<div class="notification-body">
						<p class="mb-1"><strong>{$v.full_name}</strong> {lang($v.activity)} <strong></strong></p>
						<span class="notification-time">{$v.date}</span>

					</div>
				</a>
				{/foreach}

			</div>
		</div>
	</div>
</div>
</main>


{/block}
{block name="footer"}
<script src="{assets_url()}plugins/select2/select2.min.js"></script>

<script type="text/javascript">
	$(document).ready(function(){
		$('.user_name_ajax').select2({
			placeholder:  '{lang('select_a_user')} ',
			ajax: {
				url: '{base_url()}admin/autocomplete/getUser_ajax',
				type:'post',
				dataType: 'json',
				delay: 250,
				processResults: function (data) { 
					return {
						results: data
					};

				},
				cache: true
			}

		}); 
	});
</script>
{/block}